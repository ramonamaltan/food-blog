<div class="page-container">
  <div class="desktop-button-flex">
    <h1>Alle Rezepte</h1>
    <%= link_to 'Rezept hinzufügen', new_recipe_path, class: "btn-petrol my-3" %>
  </div>

  <div class="search-form-control">
    <%= form_with model: @recipe, method: :get, remote: true do |form| %>
      <%= form.text_field :search, class: "form-control my-3", placeholder: "Finde ein Rezept" %>
      <%= submit_tag "Suchen", class: "btn btn-red" %>
    <% end %>
  </div>

  <%= form_with model: @recipe, method: :get, remote: true, class: 'mb-4' do |form| %>
    <%= form.fields_for :categories do |cat_form| %>
      <%= cat_form.collection_select :category, Category.order(:name), :id, :name, onclick: 'this.form.submit()'  %>
    <% end %>
  
    <%= form.label :recent, 'Neue zuerst' %>
    <%= form.check_box :recent, onclick: 'this.form.submit()' %>
    <%= form.label :alphabetical, 'A-Z' %>
    <%= form.check_box :alphabetical, onclick: 'this.form.submit()' %>
  <% end %>

  <div class="cards">
    <% @recipes.each do |recipe| %>
      <div class="recipe-card">
      <% if recipe.photo.attached? %>
        <%= cl_image_tag recipe.photo.key, height: 300, width: 400, crop: :fill %>
      <% end %>
        
        <div class="recipe-infos">
          <h2 class="mb-2"><%= link_to recipe.name, recipe_path(recipe) %></h2>
          <ul class="mb-2">
            <% recipe.categories.each do |category| %>
              <li><%= category.name %></li>
            <% end %> 
          </ul>
          <%= link_to "Löschen", recipe, method: :delete, remote: true, data: { confirm: 'Are you sure?' }, class: 'delete' %>
          
        </div>
      </div>
    <% end %>
  </div>
</div>
